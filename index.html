<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TITAN ALADDIN | TERMINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #050505;
            color: #ffffff;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .terminal-border {
            border: 2px solid #D4AF37;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
        }
        .btn-execute {
            background-color: #D4AF37;
            color: #000;
            font-weight: bold;
            transition: all 0.2s;
            cursor: pointer;
        }
        .btn-execute:hover {
            background-color: #f1c40f;
            box-shadow: 0 0 15px #D4AF37;
        }
        .btn-execute:disabled {
            background-color: #444;
            color: #888;
            cursor: not-allowed;
        }
        #output-console {
            background: rgba(10, 10, 10, 0.9);
            border: 1px solid #333;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
    </style>
</head>
<body>

    <div class="flex flex-col h-full gap-4 max-w-6xl mx-auto w-full">
        <!-- HEADER -->
        <div class="flex justify-between items-center border-b border-yellow-700/50 pb-2">
            <h1 class="text-2xl font-bold text-yellow-500 tracking-tighter">TITAN ALADDIN <span class="text-white text-sm font-normal">v2.5 ELITE</span></h1>
            <div id="status" class="text-[10px] text-green-500 font-mono">ESTADO: LISTO PARA EJECUCIÓN</div>
        </div>

        <!-- INPUT AREA -->
        <div class="flex flex-col gap-2">
            <label class="text-xs text-yellow-600 font-bold uppercase">Entrada de Comando:</label>
            <textarea id="userInput" 
                class="w-full h-40 bg-black border border-zinc-800 p-4 text-green-400 focus:border-yellow-500 outline-none transition-all font-mono resize-none"
                placeholder="Pegue aquí el análisis o comando para el núcleo..."></textarea>
        </div>

        <!-- CONTROL BUTTON -->
        <button id="runBtn" onclick="executeTitan()" class="btn-execute w-full py-4 text-lg uppercase tracking-widest rounded">
            EJECUTAR NÚCLEO TITÁN
        </button>

        <!-- OUTPUT AREA -->
        <div class="flex-1 flex flex-col gap-2 overflow-hidden">
            <label class="text-xs text-yellow-600 font-bold uppercase">Respuesta del Sistema:</label>
            <div id="output-console" class="flex-1 p-6 text-sm font-mono leading-relaxed">
                <span class="opacity-30 italic">Esperando inyección de comando...</span>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "";
        const model = "gemini-2.5-flash-preview-09-2025";

        async function executeTitan() {
            const input = document.getElementById('userInput').value;
            const output = document.getElementById('output-console');
            const btn = document.getElementById('runBtn');
            const status = document.getElementById('status');

            if (!input.trim()) {
                output.innerHTML = "<span class='text-red-500'>ERROR: No se detectó entrada de comando.</span>";
                return;
            }

            // UI Reset
            btn.disabled = true;
            btn.innerHTML = "PROCESANDO EN NÚCLEO <span class='loading-dots'></span>";
            status.innerText = "ESTADO: BUSCANDO/ANALIZANDO";
            status.className = "text-[10px] text-yellow-500 font-mono";
            output.innerHTML = "Sincronizando con el núcleo Titán...\nIniciando protocolos de análisis...";

            const systemPrompt = "ERES TITÁN ALADDIN ELITE. No adivines. Procesa el comando del Director con precisión absoluta. Si hay errores en el código o lógica que te pasen, identifícalos de inmediato. Responde en español de forma ejecutiva.";

            let retries = 5;
            let currentDelay = 1000;

            async function makeRequest() {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: input }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] },
                            tools: [{ "google_search": {} }]
                        })
                    });

                    if (!response.ok) throw new Error(`Status ${response.status}`);
                    
                    const data = await response.json();
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text;
                    
                    if (!text) throw new Error("RESPUESTA_VACIA_NUCLEO");
                    
                    return text;
                } catch (err) {
                    if (retries > 0) {
                        retries--;
                        await new Promise(r => setTimeout(r, currentDelay));
                        currentDelay *= 2;
                        return makeRequest();
                    }
                    throw err;
                }
            }

            try {
                const result = await makeRequest();
                output.innerHTML = `<div class="text-white">${result.replace(/\n/g, '<br>')}</div>`;
                status.innerText = "ESTADO: OPERACIÓN EXITOSA";
                status.className = "text-[10px] text-green-500 font-mono";
            } catch (error) {
                status.innerText = "ESTADO: FALLO DE CONEXIÓN";
                status.className = "text-[10px] text-red-500 font-mono";
                output.innerHTML = `<div class="text-red-500 font-bold">ERROR DE COMUNICACIÓN CON EL NÚCLEO TITÁN.</div>
                                    <div class="text-red-400 text-xs mt-2">Causa: ${error.message}</div>
                                    <div class="text-gray-500 text-[10px] mt-4 italic">Verifique que no haya bloqueadores de red y reintente la sincronización.</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = "EJECUTAR NÚCLEO TITÁN";
            }
        }
    </script>
</body>
</html>
