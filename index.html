<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TITAN ALADDIN | NÚCLEO ELITE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --terminal-red: #ff3131;
            --bg-deep: #050508;
        }
        body {
            background-color: var(--bg-deep);
            color: #e0e0e0;
            font-family: 'JetBrains Mono', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .gold-glow { box-shadow: 0 0 15px rgba(212, 175, 55, 0.1); }
        .border-gold-low { border: 1px solid rgba(212, 175, 55, 0.2); }
        .scanline {
            position: absolute; width: 100%; height: 2px;
            background: rgba(212, 175, 55, 0.1);
            animation: scan 3s linear infinite;
            z-index: 50;
        }
        @keyframes scan { from { top: 0%; } to { top: 100%; } }
        .loading-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="p-3 gap-3">

    <!-- HEADER ELITE -->
    <header class="flex justify-between items-center bg-black/60 p-4 border-b-2 border-gold-low rounded-t-xl">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 border-2 border-gold flex items-center justify-center rotate-45 bg-gold/10">
                <span class="rotate-[-45deg] font-bold text-gold">A</span>
            </div>
            <div>
                <h1 class="text-xl font-bold tracking-tighter text-white" style="font-family: 'Cinzel', serif;">
                    ALADDIN <span class="text-gold">NÚCLEO ELITE</span>
                </h1>
                <p class="text-[9px] text-gray-500 uppercase tracking-widest">Protocolo de Análisis de Alta Fidelidad</p>
            </div>
        </div>
        <div class="text-right">
            <div id="status-badge" class="px-3 py-1 bg-green-900/30 text-green-400 text-[10px] font-bold border border-green-500/30 rounded-full">SISTEMA NOMINAL</div>
            <div id="timer" class="text-xs text-gray-400 mt-1 font-mono">2025-12-31 | 00:00:00</div>
        </div>
    </header>

    <div class="flex flex-1 gap-3 overflow-hidden">
        <!-- SECCIÓN DE COMANDO -->
        <div class="w-1/3 flex flex-col gap-3">
            <div class="flex-1 bg-black/40 border border-gold-low p-4 rounded-xl flex flex-col gap-3 relative">
                <div class="scanline"></div>
                <label class="text-[10px] text-gold font-bold uppercase tracking-widest">Entrada de Comando Director</label>
                <textarea id="cmd-input" 
                    class="flex-1 bg-black/80 border border-white/5 p-4 text-sm text-gray-200 outline-none focus:border-gold/50 transition-colors resize-none font-mono placeholder:text-gray-700"
                    placeholder="Escriba o pegue la intención de prueba aquí..."></textarea>
                
                <button onclick="runEliteAnalysis()" id="execute-btn"
                    class="bg-gold text-black font-bold py-4 rounded-lg hover:bg-yellow-500 transition-all active:scale-95 uppercase text-xs tracking-widest shadow-lg shadow-gold/20">
                    Ejecutar Diagnóstico Élite
                </button>
            </div>
        </div>

        <!-- SECCIÓN DE RESULTADOS -->
        <div class="flex-1 flex flex-col gap-3">
            <div class="flex-1 bg-black/40 border border-gold-low rounded-xl overflow-hidden flex flex-col">
                <div class="bg-white/5 p-2 flex items-center justify-between border-b border-white/5">
                    <span class="text-[9px] text-gray-500 font-bold uppercase px-2">Monitor de Salida Cuántica</span>
                    <div class="flex gap-1">
                        <div class="w-2 h-2 rounded-full bg-red-500/50"></div>
                        <div class="w-2 h-2 rounded-full bg-yellow-500/50"></div>
                        <div class="w-2 h-2 rounded-full bg-green-500/50"></div>
                    </div>
                </div>
                <div id="output-stream" class="flex-1 p-6 overflow-y-auto space-y-4 text-sm leading-relaxed text-gray-300">
                    <div class="h-full flex flex-col items-center justify-center opacity-20">
                        <svg class="w-20 h-20 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                        <p class="text-xs uppercase tracking-[0.3em]">Esperando Inyección de Datos</p>
                    </div>
                </div>
            </div>

            <!-- LOGS TÉCNICOS -->
            <div class="h-28 bg-black/80 border border-white/5 p-3 rounded-xl font-mono text-[10px] overflow-y-auto" id="log-console">
                <div class="text-blue-400">[SYS] Buffer de memoria purgado.</div>
                <div class="text-blue-400">[SYS] Conectando con Gemini 2.5 Flash Preview...</div>
                <div class="text-green-500">[SYS] Enlace establecido. Sin latencia detectada.</div>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "";
        const model = "gemini-2.5-flash-preview-09-2025";

        function updateTime() {
            document.getElementById('timer').innerText = new Date().toLocaleString('es-ES');
        }
        setInterval(updateTime, 1000);

        function writeLog(msg, color = 'text-gray-500') {
            const console = document.getElementById('log-console');
            const entry = document.createElement('div');
            entry.className = color;
            entry.innerHTML = `[${new Date().toLocaleTimeString()}] ${msg}`;
            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
        }

        async function runEliteAnalysis() {
            const input = document.getElementById('cmd-input').value;
            const output = document.getElementById('output-stream');
            const btn = document.getElementById('execute-btn');
            const badge = document.getElementById('status-badge');

            if (!input.trim()) return;

            // UI State
            btn.disabled = true;
            btn.innerHTML = `<span class="loading-pulse">Analizando...</span>`;
            badge.innerText = "PROCESANDO";
            badge.className = "px-3 py-1 bg-yellow-900/30 text-yellow-400 text-[10px] font-bold border border-yellow-500/30 rounded-full";
            
            output.innerHTML = `<div class="flex flex-col gap-3">
                <div class="h-4 bg-white/5 rounded w-full animate-pulse"></div>
                <div class="h-4 bg-white/5 rounded w-5/6 animate-pulse"></div>
                <div class="h-4 bg-white/5 rounded w-4/6 animate-pulse"></div>
            </div>`;

            const systemPrompt = `ACTÚA COMO TITÁN ALADDIN ELITE.
            Tu misión es analizar el comando del Director Nixon.
            - No adivines. Si falta información, pídela con autoridad.
            - Identifica fallos de lógica, de mercado o de código con precisión quirúrgica.
            - Usa herramientas de búsqueda si el comando menciona datos externos o de 2025.
            - Formato: Técnico, ejecutivo, directo.`;

            let retries = 5;
            let delay = 1000;

            async function callAPI() {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: input }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] },
                            tools: [{ "google_search": {} }]
                        })
                    });

                    if (!response.ok) throw new Error(`HTTP_${response.status}`);
                    
                    const data = await response.json();
                    const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                    
                    if (!resultText) throw new Error("CONTENIDO_VACIO");
                    
                    return resultText;
                } catch (err) {
                    if (retries > 0) {
                        writeLog(`Reintento de sincronización (${6-retries}/5)...`, 'text-yellow-500');
                        retries--;
                        await new Promise(r => setTimeout(r, delay));
                        delay *= 2;
                        return callAPI();
                    }
                    throw err;
                }
            }

            try {
                const text = await callAPI();
                writeLog("Análisis completado. Integridad de datos: 100%", "text-green-500");
                badge.innerText = "SISTEMA NOMINAL";
                badge.className = "px-3 py-1 bg-green-900/30 text-green-400 text-[10px] font-bold border border-green-500/30 rounded-full";
                
                // Formatear salida con estilo de reporte
                output.innerHTML = `<div class="animate-in fade-in duration-500 font-sans">
                    <div class="text-[10px] text-gold mb-2 border-b border-gold/20 pb-1">EJECUCIÓN_ÉLITE_CONFIRMADA</div>
                    <div class="space-y-4">
                        ${text.split('\n').filter(p => p.trim()).map(p => `<p class="border-l-2 border-gold/10 pl-3">${p}</p>`).join('')}
                    </div>
                </div>`;
            } catch (error) {
                writeLog(`FALLO CRÍTICO: ${error.message}`, "text-red-500");
                badge.innerText = "ERROR NÚCLEO";
                badge.className = "px-3 py-1 bg-red-900/30 text-red-400 text-[10px] font-bold border border-red-500/30 rounded-full";
                output.innerHTML = `<div class="text-red-400 p-4 border border-red-500/20 bg-red-500/5">
                    <h3 class="font-bold mb-2">ERROR DE COMUNICACIÓN CON EL NÚCLEO TITÁN</h3>
                    <p class="text-xs">Causa: ${error.message}</p>
                    <p class="text-[10px] mt-4 opacity-50 italic">Sugerencia: El comando enviado podría estar excediendo los límites de seguridad o el formato de entrada no es compatible con el buffer actual.</p>
                </div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = `Ejecutar Diagnóstico Élite`;
            }
        }
    </script>
</body>
</html>
